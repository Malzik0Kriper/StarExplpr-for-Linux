name: Збірка Linux i686 для TinyStarExplor

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build-i686:
    runs-on: ubuntu-latest

    steps:
      - name: Отримання вихідного коду
        uses: actions/checkout@v4

      - name: Збірка у 32-бітному контейнері Docker
        run: |
          docker run --rm -v ${{ github.workspace }}:/src i386/ubuntu:20.04 /bin/bash -c "
            apt-get update && \
            DEBIAN_FRONTEND=noninteractive apt-get install -y \
              python3 python3-pip python3-tk binutils libtk8.6 \
              python3-dev build-essential libjpeg-dev zlib1g-dev && \
            pip3 install --upgrade pip && \
            pip3 install pyinstaller && \
            cd /src && \
            python3 -m PyInstaller --onefile --noconsole \
              --name='TinyStarExplor' TinyStarExplor.py
          "

      - name: Завантажити готовий файл
        uses: actions/upload-artifact@v4
        with:
          name: TinyStarExplor-Linux-i686
          path: dist/TinyStarExplor
